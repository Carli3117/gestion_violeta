
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Notificaciones y Tareas Pendientes | Violeta Workspace</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap Icons + Google Fonts (Inter) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Inter:400,600,700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', Arial, sans-serif; background: #f7f7fb; margin: 0; color: #22223a; }
        .main-container { max-width: 1340px; margin: 0 auto; padding: 22px 14px; }
        .panel-title { font-weight: 700; font-size: 1.22em; color: #7C3AED; margin-bottom: 0.7em; letter-spacing:.01em;}
        .flex-panels { display: flex; gap: 28px; }
        .panel {
            background: #fff; border-radius: 13px; box-shadow: 0 2px 22px #8c78ca1c;
            padding: 23px 19px; flex: 1 1 0; min-width: 0;
        }
        .panel-right { max-width: 340px; min-width: 240px; }
        .tareas-list, .notificaciones-list { margin:0; padding:0; list-style: none; }
        .tarea-card {
            background: #ede9fe; color: #35286a; border-radius: 9px;
            padding: 11px 14px 10px 15px; margin-bottom: 10px;
            box-shadow: 0 2px 10px #b2a0e82b;
            border-left: 5px solid #7C3AED;
        }
        .tarea-card .titulo { font-weight: 600; font-size: 1.05em;}
        .tarea-card .proyecto { color: #7C3AED; font-size: .97em; font-weight: 500;}
        .tarea-card .estado { font-size: .92em; background: #fff; color: #9333ea; border-radius: 6px; padding: 2px 8px; margin-left: 10px;}
        .tarea-card .fecha { color: #666; font-size: .93em;}
        .notificacion-card {
            border-radius: 9px; background: #fafafc;
            margin-bottom: 13px; padding: 13px 17px 13px 15px;
            border-left: 5px solid #b7a8ef;
            box-shadow: 0 1px 7px #c1b0e61c;
            position: relative; transition: background .16s;
        }
        .notificacion-card.no-leida { background: #f6f3fc; border-left-color: #7C3AED;}
        .notificacion-card .mensaje { font-size: 1.02em; font-weight: 500; margin-bottom: 3px;}
        .notificacion-card .proyecto { color: #6D28D9; font-size: .96em; font-weight: 500;}
        .notificacion-card .fecha { font-size: .93em; color: #888; }
        .notificacion-card .tipo { font-size: .87em; background: #ede9fe; color: #6D28D9; border-radius: 7px; padding: 2px 9px; margin-left: 9px;}
        .volver-btn {
            display: inline-block; background: #ede9fe; color: #6D28D9;
            font-weight: 500; border-radius: 8px; padding: 8px 20px; text-decoration: none;
            margin-bottom: 28px; box-shadow: 0 1px 7px #bba8f840;
            transition: background .15s, color .14s;
        }
        .volver-btn:hover { background: #c7b9f7; color: #432874; }
        .search-box {margin-bottom: 18px; display: flex;}
        .search-box input {
            border-radius: 7px; border: 1.2px solid #d1c6ed; outline: none;
            padding: 6px 12px; font-size: 1em; width: 100%; background: #f8f7fc;
        }
        @media (max-width: 950px) { .flex-panels { flex-direction: column; gap:18px;} .panel-right{max-width:100%;}}
    </style>
</head>
<body>
    <div class="main-container">
        <a class="volver-btn" href="{{ url_for('usuario.dashboard') }}"><i class="bi bi-arrow-left"></i> Volver al panel principal</a>
        <div class="flex-panels">
            <!-- Panel de tareas pendientes (derecha) -->
            <div class="panel panel-right">
                <div class="panel-title"><i class="bi bi-kanban"></i> Tareas pendientes</div>
                <div class="search-box">
                    <input type="text" placeholder="Buscar tarea o proyecto..." id="buscarTarea" oninput="filtrarTareas()">
                </div>
                <ul class="tareas-list" id="tareasList">
                    {% for tarea in tareas_pendientes %}
                    <li class="tarea-card">
                        <div class="titulo">{{ tarea.titulo }}</div>
                        <div class="proyecto">{{ tarea.proyecto.nombre_proyecto if tarea.proyecto else 'Sin proyecto' }}</div>
                        <div class="fecha"><i class="bi bi-calendar"></i> {{ tarea.fecha_limite or tarea.fecha_creacion.strftime('%Y-%m-%d') }}</div>
                        <span class="estado">{{ tarea.estado.nombre_estado if tarea.estado else 'Sin estado' }}</span>
                    </li>
                    {% else %}
                    <li><span style="color:#aaa;">No hay tareas pendientes</span></li>
                    {% endfor %}
                </ul>
            </div>
            <!-- Panel de notificaciones (centro) -->
            <div class="panel">
                <div class="panel-title"><i class="bi bi-bell"></i> Notificaciones</div>
                <div class="search-box">
                    <input type="text" placeholder="Buscar notificaciÃ³n..." id="buscarNotif" oninput="filtrarNotificaciones()">
                </div>
                <ul class="notificaciones-list" id="notificacionesList">
                    {% for notif in notificaciones %}
                    <li class="notificacion-card {% if not notif.leida %}no-leida{% endif %}">
                        <div class="mensaje">{{ notif.mensaje }}</div>
                        <div class="proyecto">
                            {% if notif.tarea and notif.tarea.proyecto %}
                                {{ notif.tarea.proyecto.nombre_proyecto }}
                            {% else %}
                                <span style="color:#b5b;">Sin proyecto</span>
                            {% endif %}
                            {% if notif.tipo %}
                                <span class="tipo">{{ notif.tipo }}</span>
                            {% endif %}
                        </div>
                        <div class="fecha"><i class="bi bi-clock"></i> {{ notif.fecha_envio.strftime('%Y-%m-%d %H:%M') if notif.fecha_envio else '' }}</div>
                    </li>
                    {% else %}
                    <li><span style="color:#aaa;">No hay notificaciones</span></li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
<script>
function filtrarTareas() {
    var input = document.getElementById('buscarTarea').value.toLowerCase();
    var list = document.getElementById('tareasList').getElementsByTagName('li');
    for (var i = 0; i < list.length; i++) {
        var text = list[i].innerText.toLowerCase();
        list[i].style.display = text.includes(input) ? '' : 'none';
    }
}
function filtrarNotificaciones() {
    var input = document.getElementById('buscarNotif').value.toLowerCase();
    var list = document.getElementById('notificacionesList').getElementsByTagName('li');
    for (var i = 0; i < list.length; i++) {
        var text = list[i].innerText.toLowerCase();
        list[i].style.display = text.includes(input) ? '' : 'none';
    }
}
</script>
</body>
</html>
